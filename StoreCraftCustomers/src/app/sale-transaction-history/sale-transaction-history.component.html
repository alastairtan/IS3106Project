<div fxLayout="row wrap" fxLayoutGap="12px grid" fxLayoutAlign="center">
  <div class="mat-elevate-z3" fxFlex="1 1 95%" fxFlexOrder="1">
    <mat-card class="card">

      <mat-card-content>

        <div fxLayout="row wrap" fxLayoutAlign="start" fxLayoutGap="12px grid" class="productDetailsContainer">
          <div fxFlex="1 1 40%">
            <img class="productImage mat-elevation-z3" src="{{product?.productImageUrl}}" />
          </div>

          <div fxFlex="1 1 100%">

            <mat-toolbar color="primary" class="mat-elevation-z2">
              <span>My Order</span>
              <span style="flex: 1 1 auto"></span>
              <button *ngIf="currentCustomer != null" mat-raised-button>
                Write a Review
              </button>
            </mat-toolbar>
            <mat-accordion displayMode="flat">
              <mat-expansion-panel *ngFor="let saleTransaction of saleTransactions"
                [disabled]="review.customerEntity != null && isEditing">
                <mat-expansion-panel-header collapsedHeight="*" expandedHeight="*">

                  <mat-panel-title class="saleTransactions">
                    
                    Order {{saleTransaction.saleTransactionId}}

                  </mat-panel-title>

                  <mat-panel-description>
                    <mat-list role="list" style="width: 100%">
                      <mat-list-item role="listitem"><strong>{{review.reviewDate | date:'medium'}}</strong>
                      </mat-list-item>

                      <mat-list-item role="listitem">
                        <star-rating [starType]="'svg'"
                          [rating]="!(review.customerEntity != null && isEditing && review.reviewId == editReviewId)?review.productRating:updatedProductRating"
                          [readOnly]="!(review.customerEntity != null && isEditing)" (starClickChange)="onClick($event)"
                          labelText="Rating:">
                        </star-rating>
                      </mat-list-item>

                      <mat-list-item
                        *ngIf="!(review.customerEntity != null && isEditing && review.reviewId == editReviewId)"
                        role="listitem">
                        <div class="textBox">{{review.content}}</div>
                      </mat-list-item>
                      <mat-list-item
                        *ngIf="review.customerEntity != null && isEditing && review.reviewId == editReviewId"
                        role="listitem">

                        <form #updateForm="ngForm" (ngSubmit)="updateForm.valid?saveEdit():null" class="custReplyForm"
                          id="updateForm">
                          <mat-form-field class="replyContentField">
                            <textarea matInput name="updateTextArea" cdkTextareaAutosize #autosize="cdkTextareaAutosize"
                              cdkAutosizeMinRows="2" cdkAutosizeMaxRows="5" [(ngModel)]="updatedReviewContent"
                              (click)="$event.stopPropagation()" #updateTextContent="ngModel" required></textarea>
                            <mat-error *ngIf="updateTextContent.errors?.required">
                              Content is <strong>required</strong>
                            </mat-error>
                          </mat-form-field>
                        </form>

                      </mat-list-item>

                    </mat-list>
                  </mat-panel-description>
                </mat-expansion-panel-header>

              </mat-expansion-panel>
            </mat-accordion>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>